{% extends 'base_account.html' %}
{% block style %}
<style>
    .list-tag {
        font-size: 0.8em;
        font-weight: 500;
    }

    .card-personal {
        background-color: rgb(234, 234, 234);
    }

    .main-grouper {
        padding: 5%;
        width: 20em;
    }

    .details-member {
        font-size: 0.8em;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }

    .editor-members {
        border: none;
        background-color: aliceblue;
    }

    .username-floater {
        text-align: left;
        padding-left: 2%;
        margin-top: -5%;
        font-size: 0.8em;
        color: rgb(163, 163, 163);
    }

    @media (min-width: 991.98px) {
        .card-personal {
            width: 20em;
        }

        .member-image {
            width: 100px;
        }
    }

    @media (max-width: 991.98px) {
        .card-personal {
            width: 15em;
        }

        .main-grouper {
            width: 18em;
            text-align: left;
        }

        .member-image {
            width: 50px;
        }
    }

    @media (min-width: 1044px),
    (min-width: 769.91px) and (max-width: 991.98px) {
        .floater-left {
            float: left;
        }

        .floater-right {
            float: right;
        }
    }

    @media (max-width: 1044px) and (min-width: 991.98px),
    (max-width: 769.91px) {
        .floater-left {
            float: none;
            margin-bottom: -10%;
        }

        .floater-right {
            float: none;
            margin-bottom: -10%;
        }

        #space-enter {
            display: none;
        }
    }

    @media (max-width: 769.91px) {
        .floater-member {
            font-size: 1.1em;
        }

        .member-image {
            width: 100px;
        }

        .card-title {
            font-size: 0.9em;
        }
    }

    @media (min-width: 769.91px) and (max-width: 991.98px) {
        .username-floater {
            display: none;
        }
    }
</style>
<style>
    .popover {
        display: inline-block;
        cursor: pointer;
        border: none;
    }

    .popover-content {
        display: none;
        position: absolute;
        background-color: #f9f9f9;
    }

    .popover.active .popover-content {
        display: block;
    }
</style>
{% endblock %}

{% block main_block %}
<div class="container pt-4" id="main-block-inside"
    style="background-color:rgb(236, 236, 236); width: 95%; text-align: right; padding: 5%;">
    <p class="h4" style="text-align: left;">Members</p>
    <form method="post" autocomplete="off">
        <button type="submit" disabled hidden></button>
        <button class="btn btn-secondary" type="submit">Save Changes</button>
        <hr>
        {% set ns = namespace() %}
        {% set ns.index = 0 %}

        {% for i in range(members|length) %}
        {% if ns.index==0 %}
        <div class="floater-member">
            <span id="{{i}}-card" class="floater-left">
                {% else %}
                <span id="{{i}}-card" class="floater-right">
                    {% endif %}
                    <div class="card card-personal" style="background-color: white;">
                        <div class="card-body">

                            <span class="popover"><img src="../static/Personal/Images/display/edit.png" width="15px"
                                    style="margin-top: -1%; cursor: pointer;">
                                <div class="popover-content">
                                    <span type="button" id="{{members[i]['username']}}-edit"
                                        class="btn btn-outline-primary container-fluid editor-members"
                                        onclick="Javascript:edit_member(this.id.slice(0,-5))">Edit</span><br>
                                    <span type="button" id="{{members[i]['username']}}-delete"
                                        class="btn btn-outline-danger container-fluid editor-members"
                                        onclick="Javascript:delete_member(this.id.slice(0,-7))">Delete</span>
                                </div>
                            </span>

                            <img src="../static/Personal/Images/members/member_{{members[i]['avatar']}}.png"
                                style="float: left; padding-right: 5%;" class="member-image">
                            <div class="card-title {{i}}-title-name h6"
                                style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis;">
                                {{members[i]['name']}}</div>
                            <div class="details-member" style="color: rgb(168, 168, 168);">
                                {{members[i]['address']}}</div>
                            <span class="details-member">{{members[i]['phone']}}</span>
                            <a class="details-member" href="mailto:{{members[i]['email']}}">{{members[i]['email']}}</a>
                        </div>
                        <span class="username-floater">({{members[i]['username']}})</span>
                    </div><br><br>
                </span>
                {% if ns.index==1 %}
        </div>
        {% endif %}
        <span id="space-enter"><br><br><br><br><br></span>
        {% set ns.index = 1 - ns.index %}
        {% endfor %}

        <input type="text" id="deleted" name="deleted" hidden>
    </form>
</div>
{% endblock %}

{% block code %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var popover = document.getElementsByClassName("popover");

        for (let i = 0; i < popover.length; i++) {
            var popoverContent = popover[i].getElementsByClassName("popover-content");

            popover[i].addEventListener("click", function () {
                popover[i].classList.toggle("active");
            });
            document.addEventListener("click", function (event) {
                if (!popover[i].contains(event.target)) {
                    popover[i].classList.remove("active");
                }
            });

        }
    });

    function edit_member(username) {

    }

    function delete_member(username) {
        deleted = document.getElementById('deleted');
        deleted.innerHTML += username;
    }
</script>
{% endblock %}

<!-- Placing edit and delete buttons on three dots -->